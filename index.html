<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>All Ears Helpdesk</title>
  <link rel="icon" type="image/png" href="AE logo.png">
  <link rel="stylesheet" href="style.css">
  <script src="guidanceMatrix.js"></script>
  <script src="script.js" defer></script>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BNWQZX14TQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BNWQZX14TQ');
</script>
  <style>
    .form-group { margin-bottom: 1em; }
    label { font-weight: bold; }
    small { display: block; margin-top: 0.25em; }
    /* Ensure visible focus for accessibility */
    input:focus, select:focus, textarea:focus {
      outline: 2px solid #005fcc;
      outline-offset: 2px;
    }
    .required {
      color: #DC2626;
      margin-left: 2px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>All Ears Helpdesk</h1>

  <!-- Added action, method, and enctype for HTML form submission -->
  <form id="helpdeskForm" action="/submit" method="POST" enctype="multipart/form-data">
    <!-- User Role -->
    <fieldset id="fieldset1">
      <legend>How can we support you today?</legend>
      <div class="form-group">
        <label for="userRole">Your Role <span class="required">*</span></label>
        <select id="userRole" name="userRole" required autocomplete="organization-title">
          <option value="">-- Which best describes your role?--</option>
          <option value="school-staff">School Staff</option>
          <option value="hq-staff">HQ Staff</option>
          <option value="student">Student</option>
          <option value="parent">Parent</option>
          <option value="others">Others</option>
        </select>
      </div>

      <!-- Conditional text if 'Others' is selected -->
      <div id="otherRoleDiv" class="form-group" style="display:none;">
        <label for="otherRoleText">Describe your role:</label>
        <input type="text" id="otherRoleText" name="otherRoleText" style="width: 90%;" autocomplete="organization-title">
      </div>

      <div class="form-group">
        <label for="issueType">Issue Type <span class="required">*</span></label>
        <select id="issueType" name="issueType" required>
          <option value="">-- Select the primary issue you're facing --</option>
          <option value="login">Login/Accessing a Form</option>
          <option value="create-form">Creating a Form</option>
          <option value="audience">Managing Form Audience</option>
          <option value="publish">Publishing/Sharing a Form</option>
          <option value="responses">Managing Responses</option>
          <option value="collaborators">Managing Collaborators</option>
          <option value="feature-request">Feature Request</option>
          <option value="other">Other</option>
        </select>
        <small>You can use the free-text box below if there are other issues.</small>
      </div>

      <!-- Relevant Links Section -->
      <div id="relevantLinks" style="display: none;" aria-live="polite">
        <h2>Relevant Links</h2>
        <ul id="linksList"></ul>
      </div>
    </fieldset>

    <!-- Issue Type -->
    <fieldset id="fieldset2" style="display:none;">
      <legend>Tell us more <span class="required">*</span></legend>
      <div class="form-group">
        <label for="description">Issue Description <span class="required">*</span></label>
        <textarea id="description" name="description" rows="5" required placeholder="Describe the issue in your own words. Tell us what you expected, what actually happened, and what you've already tried." style="width: 90%;"></textarea>
      </div>
      <div class="form-group">
        <label for="formName">Form Name</label>
        <input type="text" id="formName" name="formName" placeholder="Title of the form you're having trouble with" style="width: 90%;">
      </div>
      <div class="form-group">
        <label for="formURL">Form Link</label>
        <input type="text" id="formURL" name="formURL" placeholder="Paste the full URL of the form, if available" style="width: 90%;">
      </div>
      <div class="form-group">
        <label for="screenshot">Upload Screenshot (JPG, PNG) <span class="required">*</span></label>
        <input type="file" id="screenshot" name="screenshot" accept="image/*" multiple aria-describedby="screenshot-desc" required>
        <small id="screenshot-desc">Upload screenshots to help us see what you are seeing.</small>
      </div>
      <div class="form-group">
        <label for="video">Upload Video (optional):</label>
        <input type="file" id="video" name="video" accept="video/*" multiple aria-describedby="video-desc">
        <small id="video-desc">Upload a screen recording if the issue is complex.</small>
      </div>
    </fieldset>

    <!-- Contact information-->
    <fieldset id="fieldset3" style="display:none;">
      <legend>Contact Information</legend>
      <div class="form-group">
        <label for="fullName">Full Name <span class="required">*</span></label>
        <input type="text" id="fullName" name="fullName" required autocomplete="name" placeholder="Please enter your full name so that we can identify you correctly" style="width: 90%;">
      </div>
      <div class="form-group">
        <label for="email">MIMS ID <span class="required">*</span></label>
        <input type="email" id="email" name="email" required autocomplete="username" placeholder="Please enter the email address you use when logging into MIMS" style="width: 90%;">
      </div>
      <div class="form-group-inline"">
        <input type="checkbox" id="useMimsAsContact" name="useMimsAsContact">
        <label for="useMimsAsContact">Use MIMS ID as Contact Email</label>
      </div>
      <div class="form-group">
        <label for="contactEmail">Contact Email <span class="required">*</span></label>
        <input type="email" id="contactEmail" name="contactEmail" required autocomplete="email" placeholder="We'll use this to update you about your request" style="width: 90%;">
      </div>
      <div class="form-group">
        <label for="school">School Name (if relevant)</label>
        <input type="text" id="school" name="school" autocomplete="organization">
      </div>
      
      <!-- Move the error banner here, just above the submit button -->
      <div id="formErrors" style="color: red; margin-bottom: 1em;"></div>
      
      <div class="form-group">
        <button type="submit" id="submitRequest" style="padding: 10px 20px; font-size: 16px;">Submit Support Request</button>
      </div>
    </fieldset>
  </form>
</body>
</html>